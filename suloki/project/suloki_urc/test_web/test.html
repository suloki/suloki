<!DOCTYPE html>
<html>
<head>
<title>Testing websockets</title>
</head>
<body>
 <div>
  <input type="submit" value="Start" onclick="start()" />
 </div>
 <div id="messages"></div>
 <script type="text/javascript">
  var number= 0;
  var webSocket =
   new WebSocket('ws://127.0.0.1:8080');
  
  webSocket.onerror = function(event) {
   onError(event)
  };
  
  webSocket.onopen = function(event) {
   onOpen(event)
  };
   
  webSocket.onclose = function(event) {
   onClose(event)
  };
  
  webSocket.onmessage = function(event) {
   onMessage(event)
  };
  
  function onMessage(event) {
   document.getElementById('messages').innerHTML
    += '<br />' + event.data;
    if(number == 1)
    {
		var strJson = "{\
			\"businessid\": \"urc\",\
			\"messageid\" : \"add\",\
			\"type\" : \"request\",\
			\"sequenceid\" : \""+number+"\",\
			\"body\" : \"val\"\,\
			\"urname\":\"/business/pstorage/key\",\
			\"urtype\":\"1\"}";
		webSocket.send(strJson);
		number++;
    }
    if(number == 2)
    {
		var strJson = "{\
			\"businessid\": \"urc\",\
			\"messageid\" : \"get\",\
			\"type\" : \"request\",\
			\"sequenceid\" : \""+number+"\",\
			\"urname\":\"/business/pstorage/key\",\
			\"urtype\":\"1\"}";
		webSocket.send(strJson);
		number++;
    }
    if(number == 3)
    {
		var strJson = "{\
			\"businessid\": \"urc\",\
			\"messageid\" : \"update\",\
			\"type\" : \"request\",\
			\"sequenceid\" : \""+number+"\",\
			\"body\" : \"val1\"\,\
			\"urname\":\"/business/pstorage/key\",\
			\"urtype\":\"1\"}";
		webSocket.send(strJson);
		number++;
    }
    if(number == 4)
    {
		var strJson = "{\
			\"businessid\": \"urc\",\
			\"messageid\" : \"get\",\
			\"type\" : \"request\",\
			\"sequenceid\" : \""+number+"\",\
			\"urname\":\"/business/pstorage/key\",\
			\"urtype\":\"1\"}";
		webSocket.send(strJson);
		number++;
    }
    if(number == 5)
    {
		var strJson = "{\
			\"businessid\": \"urc\",\
			\"messageid\" : \"del\",\
			\"type\" : \"request\",\
			\"sequenceid\" : \""+number+"\",\
			\"urname\":\"/business/pstorage/key\",\
			\"urtype\":\"1\"}";
		webSocket.send(strJson);
		number++;
    }
    if(number == 6)
    {
		var strJson = "{\
			\"businessid\": \"urc\",\
			\"messageid\" : \"get\",\
			\"type\" : \"request\",\
			\"sequenceid\" : \""+number+"\",\
			\"urname\":\"/business/pstorage/key\",\
			\"urtype\":\"1\"}";
		webSocket.send(strJson);
		number++;
    }
  }
  
  function onOpen(event) {
   document.getElementById('messages').innerHTML
    = 'Connection established';
number = 0;
   if(number == 0)
    {
		var strJson = "{\
			\"businessid\": \"auth\",\
			\"messageid\" : \"login\",\
			\"type\" : \"request\",\
			\"sequenceid\" : \""+number+"\",\
			\"body\" : {\"user\":\"guest\",\"pass\":\"guest\"}}";
		webSocket.send(strJson);
		number++;
    }
  }
   
  function onClose(event) {
   document.getElementById('messages').innerHTML
    += '<br />disconnection';
  }
  function onError(event) {
   alert(event.data);
  }
  
  function start() {
    {
		var strJson = "{\
			\"businessid\": \"ai\",\
			\"messageid\" : \"work\",\
			\"type\" : \"request\",\
			\"sequenceid\" : \""+number+"\",\
			\"body\" : {\"modelid\":\"101\",\"input\":\"0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001111111111100000000000011111111111111110000000000011111111111111110000000000001111111111100000000000000000011111100110000000000000000000001110000000000000000000000000111000000000000000000000000001110000000000000000000000000111110000000000000000000000001111110000000000000000000000011111100000000000000000000000111110000000000000000000000000111100000000000000000000011111100000000000000000000111111110000000000000000001111111110000000000000000011111111100000000000000000111111111000000000000000001111111110000000000000000000111111110000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000\"}}";
		webSocket.send(strJson);
		number++;
    }
   return false;
  }
 </script>
</body>
</html>